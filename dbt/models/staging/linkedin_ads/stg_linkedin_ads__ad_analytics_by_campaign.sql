-- This staging model prepares the LinkedIn Ads ad analytics by campaign data for further analysis.
-- It selects and standardizes the necessary columns from the source table.

WITH source AS (
    SELECT
        campaign_id,
        action_clicks,
        day,
        ad_unit_clicks,
        approximate_member_reach,
        card_clicks,
        card_impressions,
        clicks,
        comment_likes,
        comments,
        company_page_clicks,
        conversion_value_in_local_currency,
        cost_in_local_currency,
        cost_in_usd,
        external_website_conversions,
        external_website_post_click_conversions,
        external_website_post_view_conversions,
        follows,
        full_screen_plays,
        impressions,
        landing_page_clicks,
        lead_generation_mail_contact_info_shares,
        lead_generation_mail_interested_clicks,
        likes,
        one_click_lead_form_opens,
        one_click_leads,
        opens,
        other_engagements,
        sends,
        shares,
        text_url_clicks,
        total_engagements,
        video_completions,
        video_first_quartile_completions,
        video_mid_point_completions,
        video_third_quartile_completions,
        video_starts,
        video_views,
        loaded_at_time,
        'LinkedIn Ads' AS platform  
    FROM {{ source('linkedin_ads', 'ad_analytics_by_campaign') }}
)

SELECT
    campaign_id,
    action_clicks,
    day,
    ad_unit_clicks,
    approximate_member_reach,
    card_clicks,
    card_impressions,
    clicks,
    comment_likes,
    comments,
    company_page_clicks,
    conversion_value_in_local_currency,
    cost_in_local_currency,
    cost_in_usd,
    external_website_conversions,
    external_website_post_click_conversions,
    external_website_post_view_conversions,
    follows,
    full_screen_plays,
    impressions,
    landing_page_clicks,
    lead_generation_mail_contact_info_shares,
    lead_generation_mail_interested_clicks,
    likes,
    one_click_lead_form_opens,
    one_click_leads,
    opens,
    other_engagements,
    sends,
    shares,
    text_url_clicks,
    total_engagements,
    video_completions,
    video_first_quartile_completions,
    video_mid_point_completions,
    video_third_quartile_completions,
    video_starts,
    video_views,
    loaded_at_time,
    platform 
FROM source